% Préambule
% ---
\documentclass[12pt]{article}

% Paquets utilisés
% ---
\usepackage{amsmath} % Advanced math typesetting
\usepackage[utf8]{inputenc} % Unicode support (Umlauts etc.)w
\usepackage[french]{babel} % Change hyphenation rules
\usepackage[T1]{fontenc} % for farenheit
\usepackage{textcomp}
\usepackage{gensymb}
\usepackage{hyperref}
\usepackage{siunitx}
\usepackage{xcolor}

\usepackage{graphicx}
\graphicspath{{../resources/images/}}

\usepackage{minted}
\renewcommand{\theFancyVerbLine}{\sffamily \textcolor[rgb]{0.0,0.0,0.0}{\oldstylenums{\arabic{FancyVerbLine}}}}


\begin{document}

%%
% Page de couverture sur-mesure
%%

\begin{titlepage}
	\centering
	
	{\scshape\large TPE Mathématiques et SVT\par}
	\vspace{0.2cm}	
	{ \Large Thème : l'aléatoire, l'insolite, le prévisible\par }
	Axe de recherche : comprendre le présent, penser le futur\par
	\vspace{1.5cm}

	{\scshape\LARGE La modélisation informatique du climat \par}
	\vspace{1cm}
	{\huge\bfseries Comment peut-on modéliser l'irradiation solaire, et traduire cette modélisation mathématique en programme informatique ?\par}

	\vspace{1cm}
	{\Large\itshape Yohaï Eliel Berreby\par}
	
	\vfill
	
	
	{\Large\bfseries Établissement : CNED\par}
	\vspace{0.2cm}
	{\Large \bfseries Série : S }

	\vfill

	{\large \today\par}
\end{titlepage}


\clearpage
\tableofcontents{}
\clearpage

%%
% Début du document
%%

\section{Introduction} 

\subsection{Des enjeux actuels}

Qui n'a jamais eu besoin d'allumer sa télévision ou de consulter son téléphone pour savoir quel temps il ferait avant de prendre un avion, de partir en vacances ou tout simplement d'aller se promener en forêt ?
Les prévisions météorologiques, toutes communes et faciles d'accès qu'elles soient, n'en présentent cependant pas moins des enjeux importants.
Ces enjeux sont \textbf{économiques}, avec par exemple la météo agricole, un outil précieux pour des millions d'agriculteurs à travers le monde, mais aussi \textbf{humains}, car prévoir une crue ou une tempête, ne serait-ce que quelques heures à l'avance, peut permettre de sauver des vies en évacuant les populations en danger.

Ces prévisions sont aujourd'hui littéralement à \emph{portée de main} avec l'avènement des applications mobiles, et pourtant elles reposent sur des constructions d'une grande complexité à la croisée des mathématiques, de la physique et de l'informatique : \textbf{les modèles}.

\subsection{Rapport au thème}

La modélisation climatique s'inscrit naturellement dans le thème choisi, à savoir \emph{"l'aléatoire, l'insolite, le prévisible"}, car, outre l'exploration du passé qu'elle permet -- un point sur lequel on reviendra plus loin --, l'un de ses principaux intérêts est la réalisation de \textbf{prévisions météorologiques}.

Elle est également aujourd'hui indissociable de l'informatique, discipline qui passionne votre serviteur, d'où le choix du sujet \emph{"la modélisation informatique du climat"}.
En effet, le volume de données que doit traiter tout modèle climatique à partir d'un certain degré de complexité est bien trop important pour qu'un être humain, même muni d'une calculatrice, puisse réaliser les calculs nécessaires : on a donc recours à des ordinateurs pour cela, car ils sont capables de réaliser ces calculs à des vitesses dépassant de très loin les capacités humaines.

\subsection{Démarche expérimentale}

Le rôle primordial des modèles dans un domaine aussi important que la météorologie m'a conduit à vouloir \textbf{explorer leur fonctionnement}.
Pour ce faire, j'ai choisi de créer un modèle simple, et de le traduire en un programme informatique, avec comme variable l'éclairement énergétique solaire, c'est-à-dire la puissance reçue du Soleil par unité de surface en un point, en \SI{}{\watt\per\square\meter}.

Cet exemple, d'une grande simplicité en comparaison avec les modèles qu'utilisent des organismes comme Météo France, présente cependant de multiples avantages :

\begin{itemize}
  \item sa \textbf{simplicité} le rend réalisable par un élève seul dans le cadre d'un TPE
  \item les calculs qu'il implique restent cependant suffisamment complexes pour \textbf{justifier la création d'un programme informatique} les réalisant automatiquement
  \item l'irradiation solaire est \textbf{relativement simple à modéliser} approximativement, car plus prévisible que le vent ou les intempéries
\end{itemize}

J'ai donc abouti, à l'aide de ressources trouvées sur Internet, à une série de calculs permettant de calculer \textbf{l'éclairement énergétique solaire} d'un point en fonction de sa position sur Terre, de la date et de l'heure.
J'ai ensuite intégré ces calculs dans un programme, et procédé à la validation expérimentale de celui-ci en le faisant fonctionner et en comparant les résultats obtenus à ceux attendus.

Le lecteur ne sera probablement pas sans remarquer l'utilisation abondante de sources anglophones dans le présent TPE.
L'anglais est en effet aujourd'hui communément considéré comme la \textit{lingua franca} \footnote{\url{https://en.wikipedia.org/wiki/List_of_lingua_francas\#English}} des sciences, et l'abondance des ressources écrites dans cette langue par rapport aux ressources francophones me poussa à mener mes recherches en anglais. 


\clearpage
\section{Les modèles en climatologie} % FIXME: awful title

\subsection{Qu'est-ce qu'un modèle ?}

On parle de modèles mathématiques, scientifiques, climatiques, ou encore informatiques -- mais qu'est-ce au juste qu'un modèle ?
Ces notions, bien que diverses, se rejoignent en un point : il s'agit de représentations de phénomènes, suffisamment simples pour qu'on puisse les appréhender et les manipuler, mais qui restent les plus proches possibles de la réalité, sans quoi elles seraient inutiles.
En ce sens, l'on peut dire que tout modèle est une \textbf{approximation du réel}.

Le modèle \emph{mathématique} est une construction formelle qui bien souvent sert de base au modèle informatique.
Les lois qui régissent le premier servent de base au second, qui, soumis à des contraintes physiques (vitesse de calcul, de transfert des données, capacité de stockage d'un volume de données grandissant), en est la traduction imparfaite, empirique, gouverné par l'expérience, approximative.
Il dépend du matériel avec lequel on l'utilise, et évolue au fur et à mesure que celui-ci devient plus rapide et capable de traiter de grands volumes de données.

\subsection{Construction de notre modèle}

Le modèle informatique que nous cherchons à construire va ainsi s'appuyer sur un modèle mathématique, que nous construirons progressivement.
Pour ce faire, je me suis principalement appuyé sur une collection de ressources du site PVEducation.org appelée \emph{Properties of Sunlight} \cite{properties_of_sunlight}.
À l'aide de ce site, j'ai déterminé comment l'on pouvait calculer l'éclairement énergétique solaire (\textit{solar irradiance} en anglais) à partir d'autres paramètres physiques, pouvant eux-mêmes être calculés à partir d'autres paramètres, et ainsi de suite jusqu'à établir une relation entre date, heure, position sur la Terre d'un point, et éclairement énergétique solaire de ce point.
Le tout forme un modèle à petite échelle, dont voici le fonctionnement.

\subsubsection{Masse d'air et atténuation du rayonnement solaire}
L'éclairement énergétique solaire d'un point à la surface de la Terre dépend fondamentalement de deux facteurs : l'éclairement énergétique \emph{au sommet de l'atmosphère}, et l'atténuation de celui-ci par l'atmosphère. 

On a ainsi (avec $I_d$ l'éclairement énergétique solaire en \SI{}{\watt\per\square\meter}, et $AM$ la masse d'air) :

\[
	I_d = 1,353 \cdot 0,7^{{AM}^{0,678}}
\]

L'éclairement énergétique solaire au sommet de l'atmosphère, si l'on se place perpendiculairement au Soleil, est d'environ \SI{1.35}{\kilo\watt\per\square\meter}.
Comme il varie peu (+/- \SI{10}{\watt\per\square\meter}), nous nous intéresserons plus particulièrement au degré d'atténuation qu'il subit.
Dans l'espace, les rayons du Soleil peuvent parcourir de grandes distances en perdant peu d'énergie, mais sitôt qu'ils pénètrent l'atmosphère, ils en perdent beaucoup par diffusion et absorption.
Leur degré d'atténuation est fonction de la distance qu'ils parcourent dans l'atmosphère, c'est pourquoi on utilise pour le calculer un paramètre appelé \emph{masse d'air} (ou \emph{masse atmosphérique} -- \textit{air mass} en anglais) \cite{air_mass_wiki} qui représente le rapport de la longueur du plus court chemin possible au travers de l'atmosphère sur celle du chemin emprunté par la lumière à un instant donné (figure ~\ref{fig:air-mass}). Plus ce coefficient est élevé, plus les rayons du Soleil doivent parcourir une distance importante, et plus ils sont atténués par l'atmosphère.

\begin{figure}[!ht]
	\centerline{\includegraphics[width=12cm]{air-mass.png}}
	\caption{La masse d'air à un instant et en un point donné (\textit{air mass} en anglais) est définie par X (chemin le plus court que peuvent prendre les rayons du Soleil) divisé par Y (chemin qu'ils prennent à cet instant et en ce point).}
	\label{fig:air-mass}
\end{figure}

La distance parcourue par les rayons du Soleil ($Y$ sur la figure ~\ref{fig:air-mass}) est égale à $\cos \theta$ ($\theta$ est l'angle zénithal, que nous décrirons plus loin).
La masse d'air est donc égale à :

\[\frac{1 }{\cos \theta}\]


\subsubsection{Angle zénithal, d'élévation, de déclinaison}
$\theta$ est \emph{l'angle zénithal}. L'angle zénithal et l'angle d'élévation ($\alpha$) étant complémentaires, on a :
\[90\degree - \alpha\]

L'angle d'élévation $\alpha$ est plus complexe à calculer, car il est fonction de la latitude du point étudié (il convient de rappeler qu'il s'agit de calculer l'éclairement énergétique d'un point à la surface de la Terre), de \emph{l'angle de déclinaison} et de \emph{l'angle horaire}.

\begin{figure}[!ht]
	\centerline{\includegraphics[width=7cm]{elevation-and-zenith-angle.png}}
	\caption{Angle zénithal et angle d'élévation}
	\label{fig:elevation-and-zenith-angle}
\end{figure}

L'angle de déclinaison $\delta$ est ``l'angle entre la droite joignant les centres du Soleil et de la Terre et le plan de l'équateur terrestre'' \cite{mouvement_terre}. Il dépend de la position de la Terre autour du Soleil, et donc du \emph{jour de l'année} (allant de 1 à 365).

% TODO: illustration sur le tableau

\[
	\delta = \sin^{-1} \left(
		\sin \left( 23,45\degree \right)
		\sin \left(
			\frac{360}{365}
			\left(
				\text{jour de l'année} - 81
			\right)
		\right)
	\right)
\]



\subsubsection{Angle horaire et temps solaire} % XXX

L'angle horaire est l'arc que décrit le Soleil au cours de la journée, et dépend donc de l'heure.
La Terre ne tournant pas seulement sur elle-même mais également autour du Soleil, il y a décalage entre l'heure \emph{locale} (i.e. celle qu'indique un ordinateur ou une horloge) et l'heure \emph{solaire}, qui est définie par la position apparente du Soleil dans le ciel.
On doit donc utiliser l'heure solaire, et non l'heure locale, pour calculer l'angle horaire.
Pour cela, on calcule une valeur appelée facteur de correction du temps, qui est la différence entre l'heure solaire et l'heure locale.
Cette valeur est fonction de la longitude du point étudié, de la longitude du méridien local à ce point et de l'équation du temps, un paramètre qui permet de corriger l'irrégularité du temps solaire, celui-ci n'évoluant pas de manière monotone.\footnote{\textit{``Remarque sur le mot ``équation'' : en astronomie ancienne, le terme ``équation'' désignait une correction ajoutée algébriquement à une valeur moyenne pour obtenir une valeur vraie.
C'est une telle acception qui a survécu dans l'expression ``équation du temps'' ''} \cite{equation_temps_wiki}.}

\[
	\text{longitude du méridien local} = 15 \degree \cdot \Delta T_{GMT}
\]

\begin{gather*}
	B = \frac{360}{365} \left( d - 81 \right) \\
	\text{équation du temps} = 9,87 \sin \left( 2B \right) - 7,53 \cos \left( B \right) - 1,5 \sin \left( B \right)
\end{gather*}

\begin{multline*}
	\text{facteur de correction de l'heure} = 4 \left( \text{longitude} - \text{longitude du méridien local} \right) \\ + \text{équation du temps}
\end{multline*}

\[
	\text{heure solaire} = \text{heure locale} + \frac{\text{facteur de correction de l'heure}}{60}
\]

\[
	\text{angle horaire} = 15 \degree \left(
		\text{heure solaire} - 12
	\right)
\]

$\Delta T_{GMT}$ est le décalage horaire, en heures, par rapport à l'heure GMT. Ainsi, par exemple, $\Delta T_{GMT}$ vaudra $1$ pour Paris, car son fuseau horaire est GMT+1.



\subsubsection{Combinaison des paramètres}
La combinaison de tous ces paramètres permet de calculer une approximation de l'éclairement énergétique solaire en un point à partir de la position de ce point, de la date, de l'heure locale et du fuseau horaire seulement.
Le fuseau horaire doit être indiqué explicitement car on ne peut le déduire simplement à partir de la latitude, les limites des fuseaux horaires tendant à suivre les frontières des pays au lieu d'être rectilignes, comme le montre la figure ~\ref{fig:timezones}.+

\begin{figure}[!ht]
  \centering
      \makebox[\textwidth]{\includegraphics[width=\paperwidth]{timezones.png}}
  \caption{Les fuseaux horaires, dont les limites sont représentées par des lignes rouges, suivent souvent les contours des pays.}
  \label{fig:timezones}
\end{figure}

Cette approximation ne tient pas compte des nuages ou d'autres phénomènes climatiques pouvant altérer le parcours des rayons du Soleil, mais reste assez proche de la réalité par temps clair.


\clearpage
\section{Application : écriture de notre programme}

Nous disposons à présent d'un petit modèle climatique.
Pour le faire fonctionner, nous allons devoir en un modèle informatique, et donc en un programme informatique.

\subsection{Bases du fonctionnement d'un programme}

Pour être exécuté, un programme doit être traduit en une série d'instructions appelée \emph{code machine}.
Ce code n'étant pas conçu pour être lu ou écrit par des êtres humains, on écrit en pratique les programmes dans des \emph{langages de programmation}, conçus pour être compréhensibles à la fois par le programmeur et par l'ordinateur.

Le texte formant un programme, écrit dans un langage de programmation, est appelé \emph{code source} du programme.
L'ordinateur traduit le code source en code machine à l'aide un programme appelé \emph{compilateur}.
Il est alors libre d'exécuter le code machine.

\subsection{Choix du langage}
Il existe de nombreux langages de programmation, chacun ayant ses propres atouts et points faibles.
Pour ce TPE, j'ai choisi d'écrire mon programme en \textbf{Rust} \footnote{\url{https://www.rust-lang.org/}}.
Il s'agit d'un langage innovant, extrêmement performant, et prévenant de nombreux bugs grâce à un système qui analyse automatiquement le code source afin de vérifier son exactitude avant la traduction en langage machine.
Ce sont ces qualités, ainsi que ma familiarité avec le langage (je l'utilise en effet depuis janvier 2015) qui ont motivé mon choix.

\subsection{Interface utilisateur}
J'ai décidé de munir mon programme d'une interface utilisateur simple, afin qu'il soit possible de l'utiliser sans connaissances en programmation. Il s'agit d'une interface dite \emph{en ligne de commande}, et non d'une interface graphique traditionnelle, afin préserver la simplicité du code. On l'utilise avec le clavier uniquement, en entrant les paramètres demandés l'un après l'autre (figure ~\ref{fig:demo}).

\begin{figure}[!ht]
  \centering
      \makebox[\textwidth]{\includegraphics[width=15cm]{program-demonstration.png}}
  \caption{Un exemple d'utilisation de mon programme, avec comme paramètres les coordonnées GPS de la tour Eiffel (48.8582° N, 2.2945° E) et la date et l'heure d'écriture de ces lignes. Seuls les trois paramètres d'entrée (latitude, longitude, date et heure locale) ont été écrits au clavier ; les variables intermédiaires et le résultat ont été calculés et affichés automatiquement.}
  \label{fig:demo}
\end{figure}

\subsection{Code source}
Le code source de mon programme est trop long pour le copier dans son intégralité, mais il est disponible publiquement sur GitHub, un site de développement collaboratif.\footnote{\url{https://github.com/yberreby/rust-climate}}.
Vous pouvez en télécharger une copie en cliquant sur "Download ZIP" dans l'interface GitHub.\footnote{\url{https://github.com/yberreby/rust-climate/archive/master.zip}}.
Il est également possible de le lire directement depuis votre navigateur, en cliquant sur les noms des fichiers dans l'interface Web.
Le code est dans \texttt{src}.

En voici un extrait (fichier \texttt{src/temperature.rs}) :

\inputminted[linenos]{rust}{rust-climate/src/temperature.rs}

\subsection{Validation expérimentale : essai du programme}

Maintenant que nous disposons d'un programme fonctionnel, il est nécessaire de le \emph{tester} pour vérifier si les résultats qu'il produit correspondent à la réalité.

\subsubsection{Résultats attendus}
D'après Wikipédia, l'éclairement énergétique solaire \emph{maximal} au niveau de la mer serait d'environ \SI{1000}{\watt\per\square\meter} \cite{earth_irradiance_wiki}, mais aucune source n'est citée.
D'après une autre source (Green Rhino Energy, une société spécialisée dans l'énergie solaire) \cite{green_rhino_irradiance}, il serait plus proche de \SI{960}{\watt\per\square\meter}.
Cette valeur ne peut être atteinte que quand le Soleil est très exactement à la verticale du point étudié, ce qui n'est pas le cas tous les jours au midi solaire, comme on pourrait le penser.

\subsubsection{Résultats obtenus}
J'ai fait fonctionner mon programme avec divers paramètres jusqu'à obtenir un .
Par définition, l'éclairement énergétique solaire maximal est atteint lorsque la masse d'air (qui est, rappelons-le, un coefficient)

Mon programme affiche un éclairement énergétique solaire maximal de \textbf{\SI{947.07}{\watt\per\square\meter}} au niveau de l'équateur, au Gabon, à 12h20 heure locale (midi heure solaire), le 22 septembre 2016 (équinoxe d'automne). Ce résultat est très proche
-- reconnaissable au coefficient de masse atmosphérique qui tend vers 1 --

\begin{figure}[!ht]
  \centering
      \makebox[\textwidth]{\includegraphics[width=15cm]{program-maximum.png}}
  %\caption{Mon programme affiche un éclairement énergétique solaire maximal de \SI{947.07}{\watt\per\square\meter} au niveau de l'équateur, au Gabon, à 12h20 heure locale (midi heure solaire), le 22 septembre 2016 (équinoxe d'automne).}
  \label{fig:maximum}
\end{figure}

\clearpage
\section{Conclusion : bilan et applications}

[à faire]


\begin{thebibliography}{99}

\bibitem{how_do_climate_models_work} 
	Kaitlin Alexander,
	\emph{How do climate models work?}\\
	\url{http://climatesight.org/2012/01/20/how-do-climate-models-work/}

\bibitem{properties_of_sunlight} 
	PVEducation.org,
	\emph{Properties of Sunlight}\\
	\url{http://www.pveducation.org/pvcdrom/properties-of-sunlight/}

\bibitem{pos_air_mass}
	PVEducation.org,
	\emph{Air Mass}\\
	\url{http://www.pveducation.org/pvcdrom/properties-of-sunlight/air-mass}

\bibitem{pos_solar_time}
	PVEducation.org,
	\emph{Solar Time}\\
	\url{http://www.pveducation.org/pvcdrom/properties-of-sunlight/solar-time}

\bibitem{pos_declination_angle}
	PVEducation.org,
	\emph{Declination Angle}\\
	\url{http://www.pveducation.org/pvcdrom/properties-of-sunlight/declination-angle}

\bibitem{pos_calculation_of_solar_insolation}
	PVEducation.org,
	\emph{Calculation of Solar Insolation}\\
	\url{http://www.pveducation.org/pvcdrom/properties-of-sunlight/calculation-of-solar-insolation}

\bibitem{mouvement_terre}
	Université du Maine,
	\emph{Mouvement de la Terre}\\
	\url{http://ressources.univ-lemans.fr/AccesLibre/UM/Pedago/physique/02/divers/mouveter.html}

\bibitem{air_mass_wiki}
	Wikipédia,
	\emph{Air Mass (solar energy)}\\
	\url{https://en.wikipedia.org/wiki/Air_mass_(solar_energy)}

\bibitem{equation_temps_wiki}
	Wikipédia,
	\emph{Équation du temps}\\
	\url{https://fr.wikipedia.org/wiki/%C3%89quation_du_temps}
	
\bibitem{irradiation_solaire_wiki}
	Wikipédia,
	\emph{Irradiation solaire}\\
	\url{https://fr.wikipedia.org/wiki/Irradiation_solaire}
	
\bibitem{earth_irradiance_wiki}
	Wikipédia,
	\emph{Solar Irradiance - Earth}\\
	\url{https://en.wikipedia.org/wiki/Solar_irradiance#Earth}
	
\bibitem{green_rhino_irradiance}
	Green Rhino Energy,
	\emph{Annual Solar Irradiance, Intermittency and Annual Variations}\\
	\url{http://www.greenrhinoenergy.com/solar/radiation/empiricalevidence.php}

\end{thebibliography}


\end{document}
